---
title: "大変すぎて死ぬかと思た"
date: 2025-04-29
layout: post
---

フィルタリング機能追加。
マジで大変すぎて、死にそうだった。
フィルタリングしようと思ったら、メモリ確保できない問題に直面してしまった。
リストの各要素にモジュール変数を使っていたからメモリを喰うようだった。
棋譜リストは１７０００件以上あるから、実体を移動せず（削除などの操作をしても）、かつモジュール変数を使わないで実現しないといけない。

最近フリーリストめっちゃ書くから、フリーリストをモジュール化(id_manager)して使いまわすようにした。
しかしこれだけでは終わらない。id_managerをそのままリストボックスに適用しようとすると順番が保持できていないので、
id_managerをラップしてlist_id_managerを作成。

次に、リストボックスは仕様が全然変わるので書き直し、　ついでに、スクロールバーモジュールを作ってあったので、リストボックス内自前描画から、そちらに移行した。

こっからも大変だったなぁ。　メインの呼び出し側も　リストボックスモジュールが旧版とかなり仕様が違うから合わせていくのがかなり苦痛だった。。。。

何とか簡素なフィルタリング機能までたどり着いた。
グルーピング機能作ったときも大変だったが今回のほうが、遥かにきつかった。
